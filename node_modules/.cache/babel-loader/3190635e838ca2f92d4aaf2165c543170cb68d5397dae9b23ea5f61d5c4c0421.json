{"ast":null,"code":"// Calculate AR summary\nexport const calculateARSummary = (customers, allSalesData) => {\n  const totalAR = customers.reduce((sum, customer) => sum + customer.totalOwed, 0);\n  const totalOverdue = customers.reduce((sum, customer) => sum + customer.overdueAmount, 0);\n  const customersWithBalance = customers.filter(customer => customer.totalOwed > 0).length;\n  const aging = getAgingData(salesData);\n\n  // Calculate real average days outstanding from actual order data\n  let totalDaysOutstanding = 0;\n  let orderCount = 0;\n  if (allSalesData) {\n    allSalesData.forEach(order => {\n      // Convert order creation date from \"2025.08.18.10.08.54.569\" to proper date\n      const orderDateStr = order.createdAt.split('.').slice(0, 3).join('-'); // \"2025-08-18\"\n      const orderDate = new Date(orderDateStr);\n      const today = new Date();\n\n      // Calculate days between order creation and today\n      const timeDiff = today.getTime() - orderDate.getTime();\n      const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));\n      totalDaysOutstanding += daysDiff;\n      orderCount++;\n    });\n  }\n  const avgDaysOutstanding = orderCount > 0 ? Math.round(totalDaysOutstanding / orderCount) : 0;\n  return {\n    totalAR,\n    totalOverdue,\n    customersWithBalance,\n    avgDaysOutstanding\n  };\n};\n\n// Get aging data\nexport const getAgingData = salesData => {\n  const aging = {\n    current: 0,\n    days30: 0,\n    days60: 0,\n    days90: 0,\n    over90: 0\n  };\n  salesData.forEach(order => {\n    if (order.paid) return;\n    const daysPastDue = order.daysOverdue || 0;\n    if (daysPastDue <= 0) {\n      aging.current += order.total;\n    } else if (daysPastDue <= 30) {\n      aging.days30 += order.total;\n    } else if (daysPastDue <= 60) {\n      aging.days60 += order.total;\n    } else if (daysPastDue <= 90) {\n      aging.days90 += order.total;\n    } else {\n      aging.over90 += order.total;\n    }\n  });\n  return aging;\n};\n\n// Filter customers\nexport const getFilteredCustomers = (customers, filters) => {\n  // First check if we have valid data\n  if (!customers || !Array.isArray(customers)) {\n    return [];\n  }\n\n  // Start by filtering ONLY customers WITH names\n  let filtered = customers.filter(customer => customer && customer.name && typeof customer.name === 'string' && customer.name.trim() !== '');\n\n  // Now apply the rest of the filters to our name-filtered list\n  if (filters && filters.customerType && filters.customerType !== 'all') {\n    filtered = filtered.filter(customer => customer.customerType === filters.customerType);\n  }\n  if (filters && filters.status && filters.status !== 'all') {\n    filtered = filtered.filter(customer => {\n      if (filters.status === 'overdue') return customer.overdueAmount > 0;\n      if (filters.status === 'current') return customer.totalOwed > 0 && customer.overdueAmount === 0;\n      if (filters.status === 'paid_up') return customer.totalOwed === 0;\n      return true;\n    });\n  }\n  if (filters && filters.searchTerm) {\n    const term = filters.searchTerm.toLowerCase();\n    filtered = filtered.filter(customer => customer.name.toLowerCase().includes(term) || customer.email && customer.email.toLowerCase().includes(term) || customer.id && customer.id.toLowerCase().includes(term));\n  }\n  console.log(`Filtered to ${filtered.length} customers with valid names`);\n  return filtered;\n};","map":{"version":3,"names":["calculateARSummary","customers","allSalesData","totalAR","reduce","sum","customer","totalOwed","totalOverdue","overdueAmount","customersWithBalance","filter","length","aging","getAgingData","salesData","totalDaysOutstanding","orderCount","forEach","order","orderDateStr","createdAt","split","slice","join","orderDate","Date","today","timeDiff","getTime","daysDiff","Math","floor","avgDaysOutstanding","round","current","days30","days60","days90","over90","paid","daysPastDue","daysOverdue","total","getFilteredCustomers","filters","Array","isArray","filtered","name","trim","customerType","status","searchTerm","term","toLowerCase","includes","email","id","console","log"],"sources":["C:/Users/Logic-Unit/my-account/src/Utility/apCalculations.js"],"sourcesContent":["// Calculate AR summary\r\nexport const calculateARSummary = (customers, allSalesData) => {\r\n  const totalAR = customers.reduce((sum, customer) => sum + customer.totalOwed, 0);\r\n  const totalOverdue = customers.reduce((sum, customer) => sum + customer.overdueAmount, 0);\r\n  const customersWithBalance = customers.filter(customer => customer.totalOwed > 0).length;\r\n    const aging = getAgingData(salesData);\r\n  \r\n  // Calculate real average days outstanding from actual order data\r\n  let totalDaysOutstanding = 0;\r\n  let orderCount = 0;\r\n  \r\n  if (allSalesData) {\r\n    allSalesData.forEach(order => {\r\n      // Convert order creation date from \"2025.08.18.10.08.54.569\" to proper date\r\n      const orderDateStr = order.createdAt.split('.').slice(0, 3).join('-'); // \"2025-08-18\"\r\n      const orderDate = new Date(orderDateStr);\r\n      const today = new Date();\r\n      \r\n      // Calculate days between order creation and today\r\n      const timeDiff = today.getTime() - orderDate.getTime();\r\n      const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));\r\n      \r\n      totalDaysOutstanding += daysDiff;\r\n      orderCount++;\r\n    });\r\n  }\r\n  \r\n  const avgDaysOutstanding = orderCount > 0 ? Math.round(totalDaysOutstanding / orderCount) : 0;\r\n\r\n  return {\r\n    totalAR,\r\n    totalOverdue,\r\n    customersWithBalance,\r\n    avgDaysOutstanding\r\n  };\r\n};\r\n\r\n// Get aging data\r\nexport const getAgingData = (salesData) => {\r\n  const aging = {\r\n    current: 0,\r\n    days30: 0,\r\n    days60: 0,\r\n    days90: 0,\r\n    over90: 0\r\n  };\r\n\r\n  salesData.forEach(order => {\r\n    if (order.paid) return;\r\n    \r\n    const daysPastDue = order.daysOverdue || 0;\r\n    \r\n    if (daysPastDue <= 0) {\r\n      aging.current += order.total;\r\n    } else if (daysPastDue <= 30) {\r\n      aging.days30 += order.total;\r\n    } else if (daysPastDue <= 60) {\r\n      aging.days60 += order.total;\r\n    } else if (daysPastDue <= 90) {\r\n      aging.days90 += order.total;\r\n    } else {\r\n      aging.over90 += order.total;\r\n    }\r\n  });\r\n\r\n  return aging;\r\n};\r\n\r\n// Filter customers\r\nexport const getFilteredCustomers = (customers, filters) => {\r\n  // First check if we have valid data\r\n  if (!customers || !Array.isArray(customers)) {\r\n    return [];\r\n  }\r\n  \r\n  // Start by filtering ONLY customers WITH names\r\n  let filtered = customers.filter(customer => \r\n    customer && \r\n    customer.name && \r\n    typeof customer.name === 'string' && \r\n    customer.name.trim() !== ''\r\n  );\r\n\r\n  // Now apply the rest of the filters to our name-filtered list\r\n  if (filters && filters.customerType && filters.customerType !== 'all') {\r\n    filtered = filtered.filter(customer => customer.customerType === filters.customerType);\r\n  }\r\n\r\n  if (filters && filters.status && filters.status !== 'all') {\r\n    filtered = filtered.filter(customer => {\r\n      if (filters.status === 'overdue') return customer.overdueAmount > 0;\r\n      if (filters.status === 'current') return customer.totalOwed > 0 && customer.overdueAmount === 0;\r\n      if (filters.status === 'paid_up') return customer.totalOwed === 0;\r\n      return true;\r\n    });\r\n  }\r\n\r\n  if (filters && filters.searchTerm) {\r\n    const term = filters.searchTerm.toLowerCase();\r\n    filtered = filtered.filter(customer =>\r\n      customer.name.toLowerCase().includes(term) ||\r\n      (customer.email && customer.email.toLowerCase().includes(term)) ||\r\n      (customer.id && customer.id.toLowerCase().includes(term))\r\n    );\r\n  }\r\n\r\n  console.log(`Filtered to ${filtered.length} customers with valid names`);\r\n  return filtered;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}