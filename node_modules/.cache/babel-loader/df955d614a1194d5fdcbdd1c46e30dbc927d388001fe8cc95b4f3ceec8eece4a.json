{"ast":null,"code":"// src/utils/apCalculations.js\n\nexport const combineVendorsWithPurchaseOrders = (vendors, purchaseOrders) => {\n  console.log(\"Starting combineVendorsWithPurchaseOrders function...\");\n\n  // Create a map for quick vendor lookup\n  const vendorMap = new Map();\n\n  // First, add all vendors with valid names to the map\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\n    vendors.data.forEach(vendor => {\n      // Only include vendors with valid names (not null, undefined, empty, or \"null\")\n      if (vendor.name && vendor.name.trim() !== '' && vendor.name !== 'null') {\n        vendorMap.set(vendor.id, {\n          ...vendor,\n          purchaseOrders: []\n        });\n      }\n    });\n  }\n\n  // Process all valid purchase orders\n  if (purchaseOrders && Array.isArray(purchaseOrders)) {\n    purchaseOrders.forEach(po => {\n      // Handle both string \"null\" and actual null values\n      const vendorId = po.Vendor_Id || po.vendor_Id;\n\n      // Only process POs with valid vendor_Id (not null, undefined, empty, or \"null\")\n      if (vendorId && vendorId !== 'null') {\n        if (vendorMap.has(vendorId)) {\n          // Add PO to existing vendor\n          vendorMap.get(vendorId).purchaseOrders.push(po);\n        } else {\n          // If vendor with valid name doesn't exist, create a placeholder\n          const uniqueKey = `${vendorId}_${po.POID || po.id}`;\n          vendorMap.set(uniqueKey, {\n            id: vendorId,\n            name: `Vendor ${vendorId}`,\n            email: 'unknown@vendor.system',\n            phone: '+000-000-0000',\n            address: 'Unknown Address',\n            vendorType: 'unknown',\n            creditLimit: 0,\n            paymentTerms: 0,\n            lastPayment: 'No payments',\n            creditStatus: 'unknown',\n            billCount: 1,\n            avgPaymentDays: 0,\n            status: 'pending',\n            type: 'Unknown',\n            poId: po.id,\n            purchaseOrders: [po]\n          });\n        }\n      }\n    });\n  }\n\n  // Convert the map back to an array and filter to only include vendors with names\n  const allVendors = Array.from(vendorMap.values());\n  const vendorsWithNames = allVendors.filter(vendor => vendor.name && vendor.name.trim() !== '' && vendor.name !== 'null');\n  return vendorsWithNames;\n};\n// utils/apCalculations.js\n\nexport const createAllVendorPOMapping = (purchaseOrders, vendors) => {\n  console.log('Starting createAllVendorPOMapping function');\n  const vendorPOMap = new Map();\n\n  // Initialize ALL vendors (even unnamed ones)\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\n    vendors.data.forEach(vendor => {\n      var _vendor$name;\n      const vendorName = vendor !== null && vendor !== void 0 && (_vendor$name = vendor.name) !== null && _vendor$name !== void 0 && _vendor$name.trim() ? vendor.name : `Unnamed Vendor (${(vendor === null || vendor === void 0 ? void 0 : vendor.id) || 'N/A'})`;\n      vendorPOMap.set(vendor.id, {\n        vendor: {\n          ...vendor,\n          name: vendorName\n        },\n        // ðŸ‘ˆ fallback included\n        purchaseOrders: []\n      });\n    });\n  }\n\n  // Assign POs to vendors\n  if (purchaseOrders && purchaseOrders.data && Array.isArray(purchaseOrders.data)) {\n    purchaseOrders.data.forEach(po => {\n      if (po.vendor_Id) {\n        // If vendor exists, push PO; otherwise create a new \"Unknown Vendor\"\n        if (vendorPOMap.has(po.vendor_Id)) {\n          vendorPOMap.get(po.vendor_Id).purchaseOrders.push(po);\n        } else {\n          const fallbackName = `Guest Vendor (${po.vendor_Id})`;\n          vendorPOMap.set(po.vendor_Id, {\n            vendor: {\n              id: po.vendor_Id,\n              name: fallbackName\n            },\n            purchaseOrders: [po]\n          });\n        }\n      }\n    });\n  }\n  return Array.from(vendorPOMap.values());\n};\nexport const createVendorPOMapping = (purchaseOrders, vendors) => {\n  console.log('Starting createVendorPOMapping function');\n  console.log('Input vendors:', vendors);\n  console.log('Input purchaseOrders:', purchaseOrders);\n  const vendorPOMap = new Map();\n\n  // Only initialize vendors with valid names\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\n    console.log(`Processing ${vendors.data.length} vendors`);\n    let validVendorCount = 0;\n    let invalidVendorCount = 0;\n    vendors.data.forEach(vendor => {\n      // Check if vendor has a valid name (not null, undefined, or empty)\n      if (vendor.name && vendor.name.trim() !== '') {\n        vendorPOMap.set(vendor.id, {\n          vendor,\n          purchaseOrders: []\n        });\n        validVendorCount++;\n        console.log(`Added vendor: ID=${vendor.id}, Name=${vendor.name}`);\n      } else {\n        invalidVendorCount++;\n        console.log(`Skipped vendor with invalid name: ID=${vendor.id}, Name=${vendor.name}`);\n      }\n    });\n    console.log(`Valid vendors added: ${validVendorCount}`);\n    console.log(`Invalid vendors skipped: ${invalidVendorCount}`);\n  } else {\n    console.warn('No valid vendors data found');\n  }\n\n  // Process purchase orders and assign them to vendors with valid names\n  if (purchaseOrders && purchaseOrders.data && Array.isArray(purchaseOrders.data)) {\n    console.log(`Processing ${purchaseOrders.data.length} purchase orders`);\n    let assignedPOCount = 0;\n    let skippedPOCount = 0;\n    purchaseOrders.data.forEach(po => {\n      // Only process POs with a valid vendor_Id that maps to a vendor with a name\n      if (po.vendor_Id && vendorPOMap.has(po.vendor_Id)) {\n        vendorPOMap.get(po.vendor_Id).purchaseOrders.push(po);\n        assignedPOCount++;\n        console.log(`Assigned PO ${po.id || po.POID} to vendor ${po.vendor_Id}`);\n      } else {\n        skippedPOCount++;\n        console.log(`Skipped PO ${po.id || po.POID}, vendor_Id=${po.vendor_Id} (not found in valid vendors)`);\n      }\n    });\n    console.log(`POs assigned to vendors: ${assignedPOCount}`);\n    console.log(`POs skipped: ${skippedPOCount}`);\n  } else {\n    console.warn('No valid purchase orders data found');\n  }\n\n  // Convert the map to an array of vendor-PO pairs\n  const result = Array.from(vendorPOMap.values());\n  console.log(`\\nFinal result: ${result.length} vendor entries with their purchase orders`);\n  return result;\n};\nexport const calculateAPSummary = (vendors, purchaseOrders) => {\n  console.log(\"Starting AP Summary calculation...\");\n\n  // Get all vendors with their purchase orders (including applied ones)\n  const allVendorsWithPOs = combineVendorsWithPurchaseOrders(vendors, purchaseOrders.data);\n  console.log(`Total vendors: ${allVendorsWithPOs.length}`);\n\n  // Calculate total amounts from purchase orders\n  console.log(\"Calculating total AP from purchase orders...\");\n  // let totalAP = 0;\n  // let totalOverdue = 0;\n  // let vendorsWithBalance = 0;\n\n  // allVendorsWithPOs.forEach(vendor => {\n  //   console.log(`Processing vendor: ${vendor.name || 'Unknown Vendor'}`);\n\n  //   // Calculate vendor's pending amount (only from pending items using quantity Ã— unit price)\n  //   const vendorPending = vendor.purchaseOrders.reduce((sum, po) => {\n  //     const overallStatus = getPOOverallStatus(po);\n\n  //     if (overallStatus === 'applied') {\n  //       // Skip fully applied POs\n  //       return sum;\n  //     } else if (overallStatus === 'partial') {\n  //       // For partial POs, only calculate pending items using quantity Ã— unit price\n  //       const pendingItemsTotal = po.purchaseOrderItems.reduce((itemSum, item) => {\n  //         if (item.status !== 'applied') {\n  //           const itemTotal = (item.quantity || 0) * (item.pricePerUnit || 0);\n  //           console.log(`PO ${po.POID || po.id} - pending item: ${item.quantity} Ã— ${item.pricePerUnit} = ${itemTotal}`);\n  //           return itemSum + itemTotal;\n  //         }\n  //         return itemSum;\n  //       }, 0);\n  //       console.log(`PO ${po.POID || po.id} (partial) - pending items total: ${pendingItemsTotal}`);\n  //       return sum + pendingItemsTotal;\n  //     } else {\n  //       // For fully pending POs, calculate all items using quantity Ã— unit price\n  //       const poTotal = po.purchaseOrderItems.reduce((poSum, item) => {\n  //         const itemTotal = (item.quantity || 0) * (item.pricePerUnit || 0);\n  //         console.log(`PO ${po.POID || po.id} - pending item: ${item.quantity} Ã— ${item.pricePerUnit} = ${itemTotal}`);\n  //         return poSum + itemTotal;\n  //       }, 0);\n  //       console.log(`PO ${po.POID || po.id} (${overallStatus}) - full PO total: ${poTotal}`);\n  //       return sum + poTotal;\n  //     }\n  //   }, 0);\n\n  //   console.log(`Vendor ${vendor.name} pending amount: ${vendorPending}`);\n\n  //   // Add to total AP (which represents total pending)\n  //   totalAP += vendorPending;\n\n  //   // For overdue calculation, use a percentage of pending orders\n  //   const overdueAmount = vendorPending * 0.1; // Example: 10% of pending is overdue\n  //   totalOverdue += overdueAmount;\n\n  //   if (vendorPending > 0) {\n  //     vendorsWithBalance++;\n  //   }\n  // });\n  let totalAP = 0; // âœ… Total Pending Accounts Payable (not all POs!)\n  let vendorsWithBalance = 0; // Vendors with at least 1 pending amount\n  let totalOverdue = 0; // For overdue calculation (example: 10% of pending)\n\n  // Loop over all vendors\n  allVendorsWithPOs.forEach(vendor => {\n    console.log(`Processing vendor: ${vendor.name || 'Unknown Vendor'}`);\n    let vendorPending = 0; // Vendorâ€™s pending (unapplied) amount\n\n    vendor.purchaseOrders.forEach(po => {\n      // Now calculate pending based on overall PO status\n      const overallStatus = getPOOverallStatus(po);\n      if (overallStatus === 'applied') {\n        // fully paid â†’ no pending\n        return;\n      } else if (overallStatus === 'partial') {\n        // only items not applied\n        const pendingItemsTotal = po.purchaseOrderItems.reduce((itemSum, item) => {\n          if (item.status !== 'applied') {\n            return itemSum + (item.quantity || 0) * (item.pricePerUnit || 0);\n          }\n          return itemSum;\n        }, 0);\n        vendorPending += pendingItemsTotal;\n      } else {\n        // fully pending PO â†’ take whole PO amount\n        const poTotal = po.purchaseOrderItems.reduce((sum, item) => {\n          return sum + (item.quantity || 0) * (item.pricePerUnit || 0);\n        }, 0);\n        vendorPending += poTotal;\n      }\n    });\n    console.log(`Vendor ${vendor.name} â†’ Pending: ${vendorPending}`);\n    totalAP += vendorPending;\n    if (vendorPending > 0) {\n      vendorsWithBalance++;\n    }\n\n    // Example overdue rule: 10% of pending is overdue\n    totalOverdue += vendorPending * 0.1;\n  });\n\n  // âœ… Final metrics\n  console.log(\"ðŸ“Š Accounts Payable Summary\");\n  console.log(`Total A/P (pending only): Rs ${totalAP.toLocaleString()}`);\n  console.log(`Vendors with pending amounts: ${vendorsWithBalance}`);\n  console.log(`Total Overdue (10% rule): Rs ${totalOverdue.toLocaleString()}`);\n  console.log(`Active Vendors: ${allVendorsWithPOs.length}`);\n  allVendorsWithPOs.forEach(vendor => {\n    vendor.purchaseOrders.forEach(po => {\n      console.log(`Processing PO: ${po.POID || po.id}`);\n      const overallStatus = getPOOverallStatus(po);\n      console.log(`Overall status: ${overallStatus}`);\n      // Calculate days based on overall status\n      let days = 0;\n      switch (overallStatus) {\n        case 'pending':\n          days = 5;\n          break;\n        case 'Processing':\n          days = 10;\n          break;\n        case 'Shipped':\n          days = 20;\n          break;\n        case 'Delivered':\n          days = 30;\n          break;\n        case 'applied':\n          days = 0; // Applied orders don't contribute to days outstanding\n          break;\n        case 'partial':\n          days = 3; // Partially applied orders have fewer outstanding days\n          break;\n        default:\n          days = 15;\n      }\n      console.log(`Adding ${days} days for PO ${po.POID || po.id} with status ${overallStatus}`);\n      totalDaysOutstanding += days;\n      if (days > 0) poCount++; // Only count POs that contribute to days outstanding\n    });\n  });\n  const avgDaysOutstanding = poCount > 0 ? Math.round(totalDaysOutstanding / poCount) : 0;\n  console.log(`Average days outstanding: ${avgDaysOutstanding}`);\n  console.log(\"AP Summary calculation completed\");\n  return {\n    totalAP,\n    totalOverdue,\n    vendorsWithBalance,\n    avgDaysOutstanding\n  };\n};\nexport const getProductDetails = productId => {\n  if (!productId) return {\n    name: 'Unknown Product',\n    description: '',\n    price: 0\n  };\n  const product = (window.productsData || []).find(p => p.id === productId || p.id === String(productId));\n  if (product) {\n    return {\n      name: product.name || 'Unknown Product',\n      description: product.description || '',\n      price: product.price || 0,\n      costPrice: product.costPrice || 0,\n      quantity: product.quantity || 0\n    };\n  }\n  return {\n    name: `Product #${productId}`,\n    description: '',\n    price: 0\n  };\n};\nexport const getVendorName = (vendorId, vendorsData) => {\n  if (!vendorId || vendorId === 'null') return 'Unknown Vendor';\n  const vendor = vendorsData.find(v => v.id === vendorId);\n  return vendor ? vendor.name : 'Unknown Vendor';\n};\nexport const getCreditStatusColor = status => {\n  switch (status) {\n    case 'excellent':\n      return 'bg-green-100 text-green-800';\n    case 'good':\n      return 'bg-blue-100 text-blue-800';\n    case 'watch':\n      return 'bg-yellow-100 text-yellow-800';\n    case 'hold':\n      return 'bg-red-100 text-red-800';\n    case 'unknown':\n      return 'bg-gray-100 text-gray-800';\n    default:\n      return 'bg-gray-100 text-gray-800';\n  }\n};\nexport const getPOStatusColor = status => {\n  switch (status) {\n    case 'applied':\n      return 'bg-green-100 text-green-800';\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800';\n    case 'cancelled':\n      return 'bg-red-100 text-red-800';\n    case 'partial':\n      return 'bg-blue-100 text-blue-800';\n    default:\n      return 'bg-gray-100 text-gray-800';\n  }\n};\nexport const getPOOverallStatus = purchaseOrder => {\n  if (!purchaseOrder.purchaseOrderItems || purchaseOrder.purchaseOrderItems.length === 0) {\n    return purchaseOrder.status || 'pending';\n  }\n\n  // Check if all items are applied\n  const allItemsApplied = purchaseOrder.purchaseOrderItems.every(item => item.status === 'applied');\n  if (allItemsApplied) {\n    return 'applied';\n  }\n\n  // Check if any items are applied (mixed status)\n  const someItemsApplied = purchaseOrder.purchaseOrderItems.some(item => item.status === 'applied');\n  if (someItemsApplied) {\n    return 'partial'; // You can create a new status for partially applied POs\n  }\n\n  // Default to the PO level status or pending\n  return purchaseOrder.status || 'pending';\n};\nexport const formatCurrency = amount => {\n  return new Intl.NumberFormat('en-PK', {\n    style: 'currency',\n    currency: 'PKR',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount);\n};","map":{"version":3,"names":["combineVendorsWithPurchaseOrders","vendors","purchaseOrders","console","log","vendorMap","Map","data","Array","isArray","forEach","vendor","name","trim","set","id","po","vendorId","Vendor_Id","vendor_Id","has","get","push","uniqueKey","POID","email","phone","address","vendorType","creditLimit","paymentTerms","lastPayment","creditStatus","billCount","avgPaymentDays","status","type","poId","allVendors","from","values","vendorsWithNames","filter","createAllVendorPOMapping","vendorPOMap","_vendor$name","vendorName","fallbackName","createVendorPOMapping","length","validVendorCount","invalidVendorCount","warn","assignedPOCount","skippedPOCount","result","calculateAPSummary","allVendorsWithPOs","totalAP","vendorsWithBalance","totalOverdue","vendorPending","overallStatus","getPOOverallStatus","pendingItemsTotal","purchaseOrderItems","reduce","itemSum","item","quantity","pricePerUnit","poTotal","sum","toLocaleString","days","totalDaysOutstanding","poCount","avgDaysOutstanding","Math","round","getProductDetails","productId","description","price","product","window","productsData","find","p","String","costPrice","getVendorName","vendorsData","v","getCreditStatusColor","getPOStatusColor","purchaseOrder","allItemsApplied","every","someItemsApplied","some","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format"],"sources":["C:/Users/Logic-Unit/my-account/src/utils/apCalculations.jsx"],"sourcesContent":["// src/utils/apCalculations.js\r\n\r\nexport const combineVendorsWithPurchaseOrders = (vendors, purchaseOrders) => {\r\n  console.log(\"Starting combineVendorsWithPurchaseOrders function...\");\r\n  \r\n  // Create a map for quick vendor lookup\r\n  const vendorMap = new Map();\r\n  \r\n  // First, add all vendors with valid names to the map\r\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\r\n    vendors.data.forEach(vendor => {\r\n      // Only include vendors with valid names (not null, undefined, empty, or \"null\")\r\n      if (vendor.name && vendor.name.trim() !== '' && vendor.name !== 'null') {\r\n        vendorMap.set(vendor.id, {\r\n          ...vendor,\r\n          purchaseOrders: []\r\n        });\r\n      }\r\n    });\r\n  }\r\n  \r\n  // Process all valid purchase orders\r\n  if (purchaseOrders && Array.isArray(purchaseOrders)) {\r\n    purchaseOrders.forEach(po => {\r\n      // Handle both string \"null\" and actual null values\r\n      const vendorId = po.Vendor_Id || po.vendor_Id;\r\n      \r\n      // Only process POs with valid vendor_Id (not null, undefined, empty, or \"null\")\r\n      if (vendorId && vendorId !== 'null') {\r\n        if (vendorMap.has(vendorId)) {\r\n          // Add PO to existing vendor\r\n          vendorMap.get(vendorId).purchaseOrders.push(po);\r\n        } else {\r\n          // If vendor with valid name doesn't exist, create a placeholder\r\n          const uniqueKey = `${vendorId}_${po.POID || po.id}`;\r\n          \r\n          vendorMap.set(uniqueKey, {\r\n            id: vendorId,\r\n            name: `Vendor ${vendorId}`,\r\n            email: 'unknown@vendor.system',\r\n            phone: '+000-000-0000',\r\n            address: 'Unknown Address',\r\n            vendorType: 'unknown',\r\n            creditLimit: 0,\r\n            paymentTerms: 0,\r\n            lastPayment: 'No payments',\r\n            creditStatus: 'unknown',\r\n            billCount: 1,\r\n            avgPaymentDays: 0,\r\n            status: 'pending',\r\n            type: 'Unknown',\r\n            poId: po.id,\r\n            purchaseOrders: [po]\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n  \r\n  // Convert the map back to an array and filter to only include vendors with names\r\n  const allVendors = Array.from(vendorMap.values());\r\n  const vendorsWithNames = allVendors.filter(vendor => \r\n    vendor.name && vendor.name.trim() !== '' && vendor.name !== 'null'\r\n  );\r\n  \r\n  return vendorsWithNames;\r\n};\r\n// utils/apCalculations.js\r\n\r\nexport const createAllVendorPOMapping = (purchaseOrders, vendors) => {\r\n  console.log('Starting createAllVendorPOMapping function');\r\n  \r\n  const vendorPOMap = new Map();\r\n\r\n  // Initialize ALL vendors (even unnamed ones)\r\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\r\n    vendors.data.forEach(vendor => {\r\n      const vendorName = vendor?.name?.trim() \r\n        ? vendor.name \r\n        : `Unnamed Vendor (${vendor?.id || 'N/A'})`;\r\n\r\n      vendorPOMap.set(vendor.id, {\r\n        vendor: { ...vendor, name: vendorName }, // ðŸ‘ˆ fallback included\r\n        purchaseOrders: []\r\n      });\r\n    });\r\n  }\r\n\r\n  // Assign POs to vendors\r\n  if (purchaseOrders && purchaseOrders.data && Array.isArray(purchaseOrders.data)) {\r\n    purchaseOrders.data.forEach(po => {\r\n      if (po.vendor_Id) {\r\n        // If vendor exists, push PO; otherwise create a new \"Unknown Vendor\"\r\n        if (vendorPOMap.has(po.vendor_Id)) {\r\n          vendorPOMap.get(po.vendor_Id).purchaseOrders.push(po);\r\n        } else {\r\n          const fallbackName = `Guest Vendor (${po.vendor_Id})`;\r\n          vendorPOMap.set(po.vendor_Id, {\r\n            vendor: { id: po.vendor_Id, name: fallbackName },\r\n            purchaseOrders: [po]\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  return Array.from(vendorPOMap.values());\r\n};\r\n\r\nexport const createVendorPOMapping = (purchaseOrders, vendors) => {\r\n  console.log('Starting createVendorPOMapping function');\r\n  console.log('Input vendors:', vendors);\r\n  console.log('Input purchaseOrders:', purchaseOrders);\r\n  \r\n  const vendorPOMap = new Map();\r\n  \r\n  // Only initialize vendors with valid names\r\n  if (vendors && vendors.data && Array.isArray(vendors.data)) {\r\n    console.log(`Processing ${vendors.data.length} vendors`);\r\n    \r\n    let validVendorCount = 0;\r\n    let invalidVendorCount = 0;\r\n    \r\n    vendors.data.forEach(vendor => {\r\n      // Check if vendor has a valid name (not null, undefined, or empty)\r\n      if (vendor.name && vendor.name.trim() !== '') {\r\n        vendorPOMap.set(vendor.id, {\r\n          vendor,\r\n          purchaseOrders: []\r\n        });\r\n        validVendorCount++;\r\n        console.log(`Added vendor: ID=${vendor.id}, Name=${vendor.name}`);\r\n      } else {\r\n        invalidVendorCount++;\r\n        console.log(`Skipped vendor with invalid name: ID=${vendor.id}, Name=${vendor.name}`);\r\n      }\r\n    });\r\n    \r\n    console.log(`Valid vendors added: ${validVendorCount}`);\r\n    console.log(`Invalid vendors skipped: ${invalidVendorCount}`);\r\n  } else {\r\n    console.warn('No valid vendors data found');\r\n  }\r\n  \r\n  // Process purchase orders and assign them to vendors with valid names\r\n  if (purchaseOrders && purchaseOrders.data && Array.isArray(purchaseOrders.data)) {\r\n    console.log(`Processing ${purchaseOrders.data.length} purchase orders`);\r\n    \r\n    let assignedPOCount = 0;\r\n    let skippedPOCount = 0;\r\n    \r\n    purchaseOrders.data.forEach(po => {\r\n      // Only process POs with a valid vendor_Id that maps to a vendor with a name\r\n      if (po.vendor_Id && vendorPOMap.has(po.vendor_Id)) {\r\n        vendorPOMap.get(po.vendor_Id).purchaseOrders.push(po);\r\n        assignedPOCount++;\r\n        console.log(`Assigned PO ${po.id || po.POID} to vendor ${po.vendor_Id}`);\r\n      } else {\r\n        skippedPOCount++;\r\n        console.log(`Skipped PO ${po.id || po.POID}, vendor_Id=${po.vendor_Id} (not found in valid vendors)`);\r\n      }\r\n    });\r\n    \r\n    console.log(`POs assigned to vendors: ${assignedPOCount}`);\r\n    console.log(`POs skipped: ${skippedPOCount}`);\r\n  } else {\r\n    console.warn('No valid purchase orders data found');\r\n  }\r\n  \r\n  // Convert the map to an array of vendor-PO pairs\r\n  const result = Array.from(vendorPOMap.values());\r\n  console.log(`\\nFinal result: ${result.length} vendor entries with their purchase orders`);\r\n  \r\n  return result;\r\n};\r\n\r\nexport const calculateAPSummary = (vendors, purchaseOrders) => {\r\n  console.log(\"Starting AP Summary calculation...\");\r\n  \r\n  // Get all vendors with their purchase orders (including applied ones)\r\n  const allVendorsWithPOs = combineVendorsWithPurchaseOrders(vendors, purchaseOrders.data);\r\n  console.log(`Total vendors: ${allVendorsWithPOs.length}`);\r\n  \r\n  // Calculate total amounts from purchase orders\r\n  console.log(\"Calculating total AP from purchase orders...\");\r\n  // let totalAP = 0;\r\n  // let totalOverdue = 0;\r\n  // let vendorsWithBalance = 0;\r\n  \r\n  // allVendorsWithPOs.forEach(vendor => {\r\n  //   console.log(`Processing vendor: ${vendor.name || 'Unknown Vendor'}`);\r\n    \r\n  //   // Calculate vendor's pending amount (only from pending items using quantity Ã— unit price)\r\n  //   const vendorPending = vendor.purchaseOrders.reduce((sum, po) => {\r\n  //     const overallStatus = getPOOverallStatus(po);\r\n      \r\n  //     if (overallStatus === 'applied') {\r\n  //       // Skip fully applied POs\r\n  //       return sum;\r\n  //     } else if (overallStatus === 'partial') {\r\n  //       // For partial POs, only calculate pending items using quantity Ã— unit price\r\n  //       const pendingItemsTotal = po.purchaseOrderItems.reduce((itemSum, item) => {\r\n  //         if (item.status !== 'applied') {\r\n  //           const itemTotal = (item.quantity || 0) * (item.pricePerUnit || 0);\r\n  //           console.log(`PO ${po.POID || po.id} - pending item: ${item.quantity} Ã— ${item.pricePerUnit} = ${itemTotal}`);\r\n  //           return itemSum + itemTotal;\r\n  //         }\r\n  //         return itemSum;\r\n  //       }, 0);\r\n  //       console.log(`PO ${po.POID || po.id} (partial) - pending items total: ${pendingItemsTotal}`);\r\n  //       return sum + pendingItemsTotal;\r\n  //     } else {\r\n  //       // For fully pending POs, calculate all items using quantity Ã— unit price\r\n  //       const poTotal = po.purchaseOrderItems.reduce((poSum, item) => {\r\n  //         const itemTotal = (item.quantity || 0) * (item.pricePerUnit || 0);\r\n  //         console.log(`PO ${po.POID || po.id} - pending item: ${item.quantity} Ã— ${item.pricePerUnit} = ${itemTotal}`);\r\n  //         return poSum + itemTotal;\r\n  //       }, 0);\r\n  //       console.log(`PO ${po.POID || po.id} (${overallStatus}) - full PO total: ${poTotal}`);\r\n  //       return sum + poTotal;\r\n  //     }\r\n  //   }, 0);\r\n    \r\n  //   console.log(`Vendor ${vendor.name} pending amount: ${vendorPending}`);\r\n    \r\n  //   // Add to total AP (which represents total pending)\r\n  //   totalAP += vendorPending;\r\n    \r\n  //   // For overdue calculation, use a percentage of pending orders\r\n  //   const overdueAmount = vendorPending * 0.1; // Example: 10% of pending is overdue\r\n  //   totalOverdue += overdueAmount;\r\n    \r\n  //   if (vendorPending > 0) {\r\n  //     vendorsWithBalance++;\r\n  //   }\r\n  // });\r\nlet totalAP = 0;              // âœ… Total Pending Accounts Payable (not all POs!)\r\nlet vendorsWithBalance = 0;   // Vendors with at least 1 pending amount\r\nlet totalOverdue = 0;         // For overdue calculation (example: 10% of pending)\r\n\r\n// Loop over all vendors\r\nallVendorsWithPOs.forEach(vendor => {\r\n  console.log(`Processing vendor: ${vendor.name || 'Unknown Vendor'}`);\r\n\r\n  let vendorPending = 0; // Vendorâ€™s pending (unapplied) amount\r\n\r\n  vendor.purchaseOrders.forEach(po => {\r\n    // Now calculate pending based on overall PO status\r\n    const overallStatus = getPOOverallStatus(po);\r\n\r\n    if (overallStatus === 'applied') {\r\n      // fully paid â†’ no pending\r\n      return;\r\n    } else if (overallStatus === 'partial') {\r\n      // only items not applied\r\n      const pendingItemsTotal = po.purchaseOrderItems.reduce((itemSum, item) => {\r\n        if (item.status !== 'applied') {\r\n          return itemSum + (item.quantity || 0) * (item.pricePerUnit || 0);\r\n        }\r\n        return itemSum;\r\n      }, 0);\r\n      vendorPending += pendingItemsTotal;\r\n    } else {\r\n      // fully pending PO â†’ take whole PO amount\r\n      const poTotal = po.purchaseOrderItems.reduce((sum, item) => {\r\n        return sum + (item.quantity || 0) * (item.pricePerUnit || 0);\r\n      }, 0);\r\n      vendorPending += poTotal;\r\n    }\r\n  });\r\n\r\n  console.log(`Vendor ${vendor.name} â†’ Pending: ${vendorPending}`);\r\n\r\n  totalAP += vendorPending;\r\n\r\n  if (vendorPending > 0) {\r\n    vendorsWithBalance++;\r\n  }\r\n\r\n  // Example overdue rule: 10% of pending is overdue\r\n  totalOverdue += vendorPending * 0.1;\r\n});\r\n\r\n// âœ… Final metrics\r\nconsole.log(\"ðŸ“Š Accounts Payable Summary\");\r\nconsole.log(`Total A/P (pending only): Rs ${totalAP.toLocaleString()}`);\r\nconsole.log(`Vendors with pending amounts: ${vendorsWithBalance}`);\r\nconsole.log(`Total Overdue (10% rule): Rs ${totalOverdue.toLocaleString()}`);\r\nconsole.log(`Active Vendors: ${allVendorsWithPOs.length}`);\r\n\r\n  allVendorsWithPOs.forEach(vendor => {\r\n    vendor.purchaseOrders.forEach(po => {\r\n      console.log(`Processing PO: ${po.POID || po.id}`);\r\n      const overallStatus = getPOOverallStatus(po);\r\n      console.log(`Overall status: ${overallStatus}`)\r\n      // Calculate days based on overall status\r\n      let days = 0;\r\n      switch(overallStatus) {\r\n        case 'pending':\r\n          days = 5;\r\n          break;\r\n        case 'Processing':\r\n          days = 10;\r\n          break;\r\n        case 'Shipped':\r\n          days = 20;\r\n          break;\r\n        case 'Delivered':\r\n          days = 30;\r\n          break;\r\n        case 'applied':\r\n          days = 0; // Applied orders don't contribute to days outstanding\r\n          break;\r\n        case 'partial':\r\n          days = 3; // Partially applied orders have fewer outstanding days\r\n          break;\r\n        default:\r\n          days = 15;\r\n      }\r\n      \r\n      console.log(`Adding ${days} days for PO ${po.POID || po.id} with status ${overallStatus}`);\r\n      totalDaysOutstanding += days;\r\n      if (days > 0) poCount++; // Only count POs that contribute to days outstanding\r\n    });\r\n  });\r\n  \r\n  const avgDaysOutstanding = poCount > 0 ? Math.round(totalDaysOutstanding / poCount) : 0;\r\n  console.log(`Average days outstanding: ${avgDaysOutstanding}`);\r\n\r\n  console.log(\"AP Summary calculation completed\");\r\n  \r\n  return {\r\n    totalAP,\r\n    totalOverdue,\r\n    vendorsWithBalance,\r\n    avgDaysOutstanding\r\n  };\r\n};\r\n\r\nexport const getProductDetails = (productId) => {\r\n  if (!productId) return { name: 'Unknown Product', description: '', price: 0 };\r\n  \r\n  const product = (window.productsData || []).find(p => \r\n    p.id === productId || p.id === String(productId)\r\n  );\r\n  \r\n  if (product) {\r\n    return {\r\n      name: product.name || 'Unknown Product',\r\n      description: product.description || '',\r\n      price: product.price || 0,\r\n      costPrice: product.costPrice || 0,\r\n      quantity: product.quantity || 0\r\n    };\r\n  }\r\n  \r\n  return { name: `Product #${productId}`, description: '', price: 0 };\r\n};\r\n\r\nexport const getVendorName = (vendorId, vendorsData) => {\r\n  if (!vendorId || vendorId === 'null') return 'Unknown Vendor';\r\n  const vendor = vendorsData.find(v => v.id === vendorId);\r\n  return vendor ? vendor.name : 'Unknown Vendor';\r\n};\r\n\r\nexport const getCreditStatusColor = (status) => {\r\n  switch (status) {\r\n    case 'excellent': return 'bg-green-100 text-green-800';\r\n    case 'good': return 'bg-blue-100 text-blue-800';\r\n    case 'watch': return 'bg-yellow-100 text-yellow-800';\r\n    case 'hold': return 'bg-red-100 text-red-800';\r\n    case 'unknown': return 'bg-gray-100 text-gray-800';\r\n    default: return 'bg-gray-100 text-gray-800';\r\n  }\r\n};\r\n\r\nexport const getPOStatusColor = (status) => {\r\n  switch (status) {\r\n    case 'applied': return 'bg-green-100 text-green-800';\r\n    case 'pending': return 'bg-yellow-100 text-yellow-800';\r\n    case 'cancelled': return 'bg-red-100 text-red-800';\r\n    case 'partial': return 'bg-blue-100 text-blue-800';\r\n    default: return 'bg-gray-100 text-gray-800';\r\n  }\r\n};\r\n\r\nexport const getPOOverallStatus = (purchaseOrder) => {\r\n  if (!purchaseOrder.purchaseOrderItems || purchaseOrder.purchaseOrderItems.length === 0) {\r\n    return purchaseOrder.status || 'pending';\r\n  }\r\n  \r\n  // Check if all items are applied\r\n  const allItemsApplied = purchaseOrder.purchaseOrderItems.every(item => \r\n    item.status === 'applied'\r\n  );\r\n  \r\n  if (allItemsApplied) {\r\n    return 'applied';\r\n  }\r\n  \r\n  // Check if any items are applied (mixed status)\r\n  const someItemsApplied = purchaseOrder.purchaseOrderItems.some(item => \r\n    item.status === 'applied'\r\n  );\r\n  \r\n  if (someItemsApplied) {\r\n    return 'partial'; // You can create a new status for partially applied POs\r\n  }\r\n  \r\n  // Default to the PO level status or pending\r\n  return purchaseOrder.status || 'pending';\r\n};\r\n\r\nexport const formatCurrency = (amount) => {\r\n  return new Intl.NumberFormat('en-PK', {\r\n    style: 'currency',\r\n    currency: 'PKR',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount);\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}